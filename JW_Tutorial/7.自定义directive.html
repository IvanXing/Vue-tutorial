<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <style>
      .content {
        width: 100px;
        height: 100px;
        background: red;
      }
    </style>
    <!-- æŒ‡ä»¤çš„ä½œç”¨ å°±æ˜¯æ“ä½œdom  æœ‰ç‰¹å®šåŠŸèƒ½ -->
    <div id="app">

      <div v-color="'red'">xxxx</div>

      <!-- <div>
        <input type="text" @focus="show" @blur="hide">
        <div class="content" v-if="isShow">content <button>ç‚¹æˆ‘</button></div>
      </div> -->

    <!-- ç‚¹å‡»å¤–è¾¹éšè— -->
      <div v-click-outside="hide">
        <input type="text" @focus="show" />
        <div class="content" v-if="isShow">content <button>ç‚¹æˆ‘å•Š</button></div>
      </div>

      <input type="text" v-focus="xx" />

    </div>
    <script src="./node_modules/vue/dist/vue.js"></script>
    <script>

      // å…¨å±€æŒ‡ä»¤ ä¸éœ€è¦æ¯ä¸ªç»„ä»¶éƒ½å¼•ç”¨ åªéœ€è¦å…¨å±€å¼•ç”¨ä¸‹å³å¯
      // el å½“å‰å…ƒç´   
      // bingdings.value æŒ‡ä»¤é‡Œèµ‹å€¼çš„å­—ç¬¦ä¸²
      // vnode è™šæ‹ŸèŠ‚ç‚¹ï¼Œç”¨å¯¹è±¡æè¿° å½“å‰ä¸Šä¸‹æ–‡ä¿¡æ¯
      Vue.directive("color", function (el, bingdings, vnode) {
        // context
        console.log('ğŸ‚ğŸ‚ğŸ‚==>', el, bingdings, vnode);
        el.style.border = `1px solid  ${bingdings.value}`;
      });


      // å›¾ç‰‡æ‡’åŠ è½½  v-scroll ç­‰
      let vm = new Vue({
        el: "#app",

        // å±€éƒ¨æŒ‡ä»¤
        directives: {
          focus: {     // æŒ‡ä»¤çš„ç”Ÿå‘½å‘¨æœŸ  // é»˜è®¤è°ƒç”¨çš„æ–¹æ³•æ˜¯bindå’Œupdate
            bind(el) {
              console.log("elç»‘å®šåˆ°é¡µé¢ä¸Šæ‰§è¡Œ", el);
            },
            inserted(el) {  // è¿™ä¸ªå…ƒç´ æ’å…¥åˆ°äº†é¡µé¢ä¸­ æ‰§è¡Œçš„é’©å­
              el.focus();
            },
            // æ‰€æœ‰çš„æ•°æ®å‘ç”Ÿå˜åŒ– éƒ½ä¼šé‡æ–°æ‰§è¡Œ
            update(el) { // ä¾èµ–çš„æ•°æ®å‘ç”Ÿå˜åŒ– ä¹Ÿä¼šè§¦å‘æ­¤æ–¹æ³•
              console.log(el);
            },
          },
          "click-outside"(el, bingdings, vnode) {
            //  ç»‘å®šç»™dcouemnt  æ•è·åˆ°äº‹ä»¶å‘ç”Ÿåœ¨è°çš„èº«ä¸Š
            document.addEventListener("click", (e) => {
              // å¦‚æœå½“å‰å…ƒç´ å†…çš„ä¸ç®¡çš„ ç‚¹å‡»å¤–é¢å°±éšè—contentæ ‡ç­¾
              if (!el.contains(e.target)) {
                vnode.context[bingdings.expression]();   // ä¸Šä¸‹æ–‡vm è¡¨è¾¾å¼hide
              }
            });
          },
        },

        data: {
          isShow: false,
          xx: "hello",
        },

        methods: {
          show() {
            this.isShow = true;
          },
          hide() {
            this.isShow = false;
          },
        },
      });
    </script>
  </body>
</html>
